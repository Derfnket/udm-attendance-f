"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7323],{7323:(C,m,i)=>{i.r(m),i.d(m,{HistoryPage:()=>v});var u=i(467),o=i(4742),g=i(1626),d=i(177),t=i(4438),p=i(5312);let f=(()=>{var e;class a{constructor(n){this.http=n,this.apiUrl=`${p.c.apiUrl}/presence`}getPresenceHistory(){const n=(new g.Lr).set("Authorization",`Bearer ${localStorage.getItem("authToken")}`);return this.http.get(`${this.apiUrl}/history`,{headers:n})}}return(e=a).\u0275fac=function(n){return new(n||e)(t.KVO(g.Qq))},e.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),a})();var y=i(8880);function P(e,a){if(1&e&&(t.j41(0,"ion-item")(1,"ion-label")(2,"h2"),t.EFF(3),t.nI1(4,"date"),t.nI1(5,"date"),t.k0s(),t.j41(6,"p"),t.EFF(7),t.k0s(),t.j41(8,"p"),t.EFF(9),t.k0s()()()),2&e){const r=a.$implicit;t.R7$(3),t.Lme("",t.i5U(4,5,r.timestamp,"shortDate")," \xe0 ",t.i5U(5,8,r.timestamp,"shortTime"),""),t.R7$(4),t.SpI("Action : ","arrival"===r.actionType?"Arriv\xe9e":"D\xe9part",""),t.R7$(2),t.Lme("Emplacement : ",r.latitude,", ",r.longitude,"")}}let v=(()=>{var e;class a{constructor(n,s,c,l){this.presenceService=n,this.loadingController=s,this.alertController=c,this.navCtrl=l,this.history=[]}ngOnInit(){this.loadHistory()}loadHistory(){var n=this;return(0,u.A)(function*(){const s=yield n.loadingController.create({message:"Chargement de l'historique..."});var c;yield s.present(),n.presenceService.getPresenceHistory().subscribe({next:(c=(0,u.A)(function*(l){n.history=l,yield s.dismiss()}),function(h){return c.apply(this,arguments)}),error:function(){var c=(0,u.A)(function*(l){yield s.dismiss(),yield(yield n.alertController.create({header:"Erreur",message:"Impossible de charger l'historique.",buttons:["OK"]})).present()});return function(h){return c.apply(this,arguments)}}()})})()}goBack(){this.navCtrl.back()}}return(e=a).\u0275fac=function(n){return new(n||e)(t.rXU(f),t.rXU(o.Xi),t.rXU(o.hG),t.rXU(y.q9))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-history"]],standalone:!0,features:[t.aNF],decls:14,vars:1,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","arrow-back-outline"],[4,"ngFor","ngForOf"]],template:function(n,s){1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),t.bIt("click",function(){return s.goBack()}),t.nrm(4,"ion-icon",2),t.k0s()(),t.j41(5,"ion-title"),t.EFF(6,"Historique des Pr\xe9sences"),t.k0s()()(),t.j41(7,"ion-content")(8,"ion-list"),t.DNE(9,P,10,11,"ion-item",3),t.k0s()(),t.j41(10,"ion-footer")(11,"ion-toolbar")(12,"ion-title"),t.EFF(13,"\xa9 2024 UdM Attendance"),t.k0s()()()),2&n&&(t.R7$(9),t.Y8G("ngForOf",s.history))},dependencies:[g.q1,o.bv,o.Jm,o.QW,o.W9,o.M0,o.eU,o.iq,o.uz,o.he,o.nf,o.BC,o.ai,d.MD,d.Sq,d.vh],styles:["ion-content[_ngcontent-%COMP%]{--background: #f7f5f8}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .6);margin-bottom:10px;border-radius:10px;padding:15px}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem;color:#4e0894}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;color:#000}ion-card[_ngcontent-%COMP%], ion-thumbnail[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}ion-footer[_ngcontent-%COMP%]{background-color:#fffc;text-align:center}ion-title[_ngcontent-%COMP%]{font-size:1rem;color:#4e0894}"]}),a})()}}]);