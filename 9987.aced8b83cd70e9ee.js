"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9987],{9987:(M,u,a)=>{a.r(u),a.d(u,{HomePage:()=>O});var n=a(4438),h=a(6766),r=a(3951),m=a(467),f=a(3860),v=a(4412);const d=(0,a(5083).F3)("Preferences",{web:()=>a.e(2924).then(a.bind(a,2924)).then(e=>new e.PreferencesWeb)});let b=(()=>{var e;class s{constructor(){}setStorage(t,o){d.set({key:t,value:o})}getStorage(t){return d.get({key:t})}removeStorage(t){d.remove({key:t})}}return(e=s).\u0275fac=function(t){return new(t||e)},e.\u0275prov=n.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),s})(),P=(()=>{var e;class s{get cart(){return this.cart$.asObservable()}constructor(){this.model=null,this.cartStoreName="barcode_cart",this.products=[],this.cart$=new v.t(null),this.storageService=(0,n.WQX)(b),this.getCart()}startScan(t){return(0,m.A)(function*(){try{const o=yield f.zT.scanBarcode({hint:t||17,cameraDirection:1});return console.log(o),o.ScanResult}catch(o){throw o}})()}addItemByBarcode(t){const o=this.products.find(i=>i.barcode==t);if(!o)throw"No such item found";this.addQuantity(o)}addQuantity(t){if(console.log(t),this.model){const o=this.model.items.findIndex(i=>i.item_id==t.id);o>=0?this.model.items[o].quantity+=1:this.model.items=this.model.items.concat([{item_id:null==t?void 0:t.id,name:null==t?void 0:t.name,description:null==t?void 0:t.description,price:+(null==t?void 0:t.price),cover:null==t?void 0:t.cover,quantity:1}])}else this.model={items:[{item_id:null==t?void 0:t.id,name:null==t?void 0:t.name,description:null==t?void 0:t.description,price:+(null==t?void 0:t.price),cover:null==t?void 0:t.cover,quantity:1}]};return this.calculate()}subtractQuantity(t){if(this.model){const i=this.model.items.findIndex(g=>g.item_id==t.id);var o;if(i>=0)return(null===(o=this.model.items[i])||void 0===o?void 0:o.quantity)>0&&(this.model.items[i].quantity-=1),this.calculate()}return null}calculate(){const t=this.model.items.filter(l=>l.quantity>0);if(0==(null==t?void 0:t.length))return void this.clearCart();let o=0,i=0;for(const l of t)o+=l.quantity,i+=l.price*l.quantity;return this.model={...this.model,items:t,totalItem:o,totalPrice:i,grandTotal:i},this.cart$.next(this.model),this.saveCart(this.model),this.model}clearCart(){this.storageService.removeStorage(this.cartStoreName),this.model=null,this.cart$.next(null)}saveCart(t){const o=JSON.stringify(t);this.storageService.setStorage(this.cartStoreName,o)}getCart(){var t=this;return(0,m.A)(function*(){let o=t.cart$.value;var i;o||(o=yield t.storageService.getStorage(t.cartStoreName),console.log(o),null!==(i=o)&&void 0!==i&&i.value&&(t.model=JSON.parse(o.value),console.log(t.model),t.cart$.next(t.model)))})()}}return(e=s).\u0275fac=function(t){return new(t||e)},e.\u0275prov=n.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),s})();var C=a(5844);let O=(()=>{var e;class s{constructor(t){this.router=t,this.isToast=!1,this.toastData={},this.totalItems=0,this.profileImage="/assets/imgs/avatar.jpg",this.userName="UdM User",this.cartService=(0,n.WQX)(P),this.authService=(0,n.WQX)(C.u)}ngOnInit(){this.cartSub=this.cartService.cart.subscribe({next:t=>{console.log(t),this.totalItems=t?null==t?void 0:t.totalItem:0}}),this.loadUserProfile()}loadUserProfile(){localStorage.getItem("userId")&&this.authService.getUserProfile().subscribe({next:o=>{const i=o.data;this.userName=i.username||"UdM User",this.profileImage=i.profileImage||"/assets/imgs/avatar.jpg"},error:o=>{console.error("Erreur lors de la r\xe9cup\xe9ration du profil:",o)}})}goToArrival(){this.router.navigate(["/arrival"])}goToDeparture(){this.router.navigate(["/departure"])}goToHistory(){this.router.navigate(["/history"])}goToProfile(){this.router.navigate(["/profile"])}ngOnDestroy(){this.cartSub&&this.cartSub.unsubscribe()}}return(e=s).\u0275fac=function(t){return new(t||e)(n.rXU(h.Ix))},e.\u0275cmp=n.VBU({type:e,selectors:[["app-home"]],standalone:!0,features:[n.aNF],decls:45,vars:15,consts:[["lines","none",1,"ion-margin-vertical"],["color","dark"],["slot","end"],["alt","Image du profil",3,"src"],[1,"ion-margin"],["size","6",1,"ion-text-center"],["color","light","routerLink","/arrival"],["name","log-in-outline","color","tertiary"],["color","light","routerLink","/departure"],["name","log-out-outline","color","warning"],["color","light","routerLink","/history"],["name","document-text-outline","color","success"],["color","light","routerLink","/profile"],["name","person-circle-outline","color","secondary"],[3,"didDismiss","isOpen","message","position","color","duration"]],template:function(t,o){1&t&&(n.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),n.EFF(3,"Page d'acceuil UdM Attendance"),n.k0s()()(),n.j41(4,"ion-content")(5,"ion-item",0)(6,"ion-label"),n.EFF(7," Bonjour, "),n.j41(8,"p")(9,"ion-text",1),n.EFF(10),n.k0s()()(),n.j41(11,"ion-thumbnail",2),n.nrm(12,"img",3),n.k0s()(),n.j41(13,"ion-list-header"),n.EFF(14," Vos Actions "),n.k0s(),n.j41(15,"ion-row",4)(16,"ion-col",5)(17,"ion-card",6)(18,"ion-thumbnail"),n.nrm(19,"ion-icon",7),n.k0s(),n.j41(20,"ion-label"),n.EFF(21,"Enregistrer Arriv\xe9e"),n.k0s()()(),n.j41(22,"ion-col",5)(23,"ion-card",8)(24,"ion-thumbnail"),n.nrm(25,"ion-icon",9),n.k0s(),n.j41(26,"ion-label"),n.EFF(27,"Enregistrer D\xe9part"),n.k0s()()(),n.j41(28,"ion-col",5)(29,"ion-card",10)(30,"ion-thumbnail"),n.nrm(31,"ion-icon",11),n.k0s(),n.j41(32,"ion-label"),n.EFF(33,"Historique des Pr\xe9sences"),n.k0s()()(),n.j41(34,"ion-col",5)(35,"ion-card",12)(36,"ion-thumbnail"),n.nrm(37,"ion-icon",13),n.k0s(),n.j41(38,"ion-label"),n.EFF(39,"Profil Utilisateur"),n.k0s()()()(),n.j41(40,"ion-toast",14),n.bIt("didDismiss",function(){return o.isToast=!1}),n.k0s()(),n.j41(41,"ion-footer")(42,"ion-toolbar")(43,"ion-title"),n.EFF(44,"\xa9 2024 UdM Attendance"),n.k0s()()()),2&t&&(n.R7$(10),n.SpI(" ",o.userName," "),n.R7$(2),n.Y8G("src",o.profileImage,n.B4B),n.R7$(6),n.xc7("background","rgba(240,94,112, 0.2)"),n.R7$(6),n.xc7("background","rgba(255,152,0, 0.2)"),n.R7$(6),n.xc7("background","rgba(76,175,80, 0.2)"),n.R7$(6),n.xc7("background","rgba(94,155,240, 0.2)"),n.R7$(4),n.Y8G("isOpen",o.isToast)("message",null==o.toastData?null:o.toastData.message)("position","bottom")("color",null==o.toastData?null:o.toastData.color)("duration",3e3))},dependencies:[r.M0,r.op,r.b_,r.hU,r.ln,r.AF,r.IO,r.he,r.uz,r.iq,r.eU,r.ai,r.BC,r.W9,r.Zx,h.Wk],styles:["ion-content[_ngcontent-%COMP%]{--background: #f7f5f8}ion-content[_ngcontent-%COMP%]   .ion-text-center[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{box-shadow:none;border-radius:20px;transform:translateY(10%);background-color:#ffffff4d;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px)}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{font-size:1rem;color:#000;padding:20px;text-align:center}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background: linear-gradient(to right, #B006D0, #4E0894);margin-top:20px}ion-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .6);margin-top:20px;border-radius:10px;padding:10px}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #f7f5f8}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{position:absolute;top:0;right:0;border-radius:50%;height:1rem;width:1rem;margin:0 -.3rem 0 0;display:flex;align-items:center;justify-content:center}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:.6rem;font-weight:700}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:5px;font-size:.9rem;font-weight:400}ion-item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:10px}ion-list-header[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:400}ion-card[_ngcontent-%COMP%]{box-shadow:none;margin:10px 5px;height:15vh;flex-direction:column}ion-card[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{border-radius:10px;width:3rem;height:3rem;margin-bottom:1.3vh}ion-card[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:2rem}ion-card[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:1rem;font-weight:500}ion-card[_ngcontent-%COMP%], ion-thumbnail[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}ion-footer[_ngcontent-%COMP%]{background-color:#fffc;text-align:center}ion-title[_ngcontent-%COMP%]{font-size:1rem;color:#4e0894}"]}),s})()}}]);