"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2150],{2150:(h,d,i)=>{i.r(d),i.d(d,{DeparturePage:()=>C});var u=i(467),n=i(4742),g=i(1626),p=i(177),t=i(4438),f=i(5844),P=i(1186),m=i(3172);function E(a,_){if(1&a&&(t.j41(0,"ion-item")(1,"ion-label",5),t.EFF(2),t.k0s()()),2&a){const l=t.XpG();t.R7$(2),t.SpI("R\xe9sultat scann\xe9 : ",l.scannedResult,"")}}let C=(()=>{var a;class _{constructor(e,r,o,c,s,O){this.authService=e,this.qrScannerService=r,this.geolocationService=o,this.alertController=c,this.loadingController=s,this.toastController=O,this.scannedResult=null}ngOnInit(){}startScan(){var e=this;return(0,u.A)(function*(){const r=yield e.loadingController.create({message:"Veuillez patienter..."});yield r.present();try{const o=yield e.qrScannerService.startScan();if(!o)throw new Error("Le QR code scann\xe9 est vide.");e.scannedResult=o;const c=yield e.authService.verifyBiometric("Authentification biom\xe9trique pour le d\xe9part");if(!c)throw new Error("\xc9chec de la v\xe9rification biom\xe9trique.");const s=yield e.geolocationService.getCurrentLocation();if(!s)throw new Error("Impossible d'obtenir la localisation GPS.");yield e.authService.recordDeparture(o,s.latitude,s.longitude,c).toPromise(),yield e.presentToast("D\xe9part enregistr\xe9 avec succ\xe8s.")}catch(o){yield e.presentAlert("Erreur",o.message||"Une erreur est survenue.")}finally{yield r.dismiss()}})()}presentAlert(e,r){var o=this;return(0,u.A)(function*(){yield(yield o.alertController.create({header:e,message:r,buttons:["OK"]})).present()})()}presentToast(e){var r=this;return(0,u.A)(function*(){(yield r.toastController.create({message:e,duration:3e3,position:"bottom"})).present()})()}ngOnDestroy(){this.qrScannerService.stopScan()}}return(a=_).\u0275fac=function(e){return new(e||a)(t.rXU(f.u),t.rXU(P.V),t.rXU(m.O),t.rXU(n.hG),t.rXU(n.Xi),t.rXU(n.K_))},a.\u0275cmp=t.VBU({type:a,selectors:[["app-departure"]],standalone:!0,features:[t.aNF],decls:18,vars:1,consts:[["slot","start"],["defaultHref","/home"],[1,"ion-text-center"],["expand","block",3,"click"],[4,"ngIf"],[1,"ion-text-wrap"]],template:function(e,r){1&e&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t.EFF(3,"Enregistrer D\xe9part"),t.k0s(),t.j41(4,"ion-buttons",0),t.nrm(5,"ion-back-button",1),t.k0s()()(),t.j41(6,"ion-content")(7,"ion-card",2)(8,"ion-card-content")(9,"p"),t.EFF(10,"Scannez le QR code pour enregistrer votre d\xe9part."),t.k0s(),t.j41(11,"ion-button",3),t.bIt("click",function(){return r.startScan()}),t.EFF(12,"Scanner QR Code"),t.k0s()()(),t.DNE(13,E,3,1,"ion-item",4),t.k0s(),t.j41(14,"ion-footer")(15,"ion-toolbar")(16,"ion-title"),t.EFF(17,"\xa9 2024 UdM Attendance"),t.k0s()()()),2&e&&(t.R7$(13),t.Y8G("ngIf",r.scannedResult))},dependencies:[g.q1,n.bv,n.Jm,n.QW,n.b_,n.I9,n.W9,n.M0,n.eU,n.uz,n.he,n.BC,n.ai,n.el,p.MD,p.bT],styles:["ion-content[_ngcontent-%COMP%]{--background: #f7f5f8}ion-content[_ngcontent-%COMP%]   .ion-text-center[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{box-shadow:none;border-radius:20px;transform:translateY(10%);background-color:#ffffff4d;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px)}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{font-size:1rem;color:#000;padding:20px;text-align:center}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background: linear-gradient(to right, #B006D0, #4E0894);margin-top:20px}ion-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .6);margin-top:20px;border-radius:10px;padding:10px}ion-card[_ngcontent-%COMP%], ion-thumbnail[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}ion-footer[_ngcontent-%COMP%]{background-color:#fffc;text-align:center}ion-title[_ngcontent-%COMP%]{font-size:1rem;color:#4e0894}"]}),_})()}}]);