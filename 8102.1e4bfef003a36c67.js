"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8102],{5083:(me,ne,_)=>{_.d(ne,{E_:()=>U,F3:()=>R,I9:()=>M,Ii:()=>h});var f=_(467);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var N=function(n){return n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE",n}(N||{});class M extends Error{constructor(e,t,s){super(e),this.message=e,this.code=t,this.data=s}}const de=n=>{var e,t,s,a,o;const p=n.CapacitorCustomPlatform||null,l=n.Capacitor||{},O=l.Plugins=l.Plugins||{},b=n.CapacitorPlatforms,Z=(null===(e=null==b?void 0:b.currentPlatform)||void 0===e?void 0:e.getPlatform)||(()=>null!==p?p.name:(n=>{var e,t;return null!=n&&n.androidBridge?"android":null!==(t=null===(e=null==n?void 0:n.webkit)||void 0===e?void 0:e.messageHandlers)&&void 0!==t&&t.bridge?"ios":"web"})(n)),C=(null===(t=null==b?void 0:b.currentPlatform)||void 0===t?void 0:t.isNativePlatform)||(()=>"web"!==Z()),B=(null===(s=null==b?void 0:b.currentPlatform)||void 0===s?void 0:s.isPluginAvailable)||(w=>{const y=fe.get(w);return!!(null!=y&&y.platforms.has(Z())||Q(w))}),Q=(null===(a=null==b?void 0:b.currentPlatform)||void 0===a?void 0:a.getPluginHeader)||(w=>{var y;return null===(y=l.PluginHeaders)||void 0===y?void 0:y.find(G=>G.name===w)}),fe=new Map,pe=(null===(o=null==b?void 0:b.currentPlatform)||void 0===o?void 0:o.registerPlugin)||((w,y={})=>{const G=fe.get(w);if(G)return console.warn(`Capacitor plugin "${w}" already registered. Cannot register plugins twice.`),G.proxy;const P=Z(),L=Q(w);let A;const K=function(){var T=(0,f.A)(function*(){return!A&&P in y?A=A="function"==typeof y[P]?yield y[P]():y[P]:null!==p&&!A&&"web"in y&&(A=A="function"==typeof y.web?yield y.web():y.web),A});return function(){return T.apply(this,arguments)}}(),W=T=>{let D;const J=(...ee)=>{const te=K().then(j=>{const ie=((T,D)=>{var J,ee;if(!L){if(T)return null===(ee=T[D])||void 0===ee?void 0:ee.bind(T);throw new M(`"${w}" plugin is not implemented on ${P}`,N.Unimplemented)}{const te=null==L?void 0:L.methods.find(j=>D===j.name);if(te)return"promise"===te.rtype?j=>l.nativePromise(w,D.toString(),j):(j,ie)=>l.nativeCallback(w,D.toString(),j,ie);if(T)return null===(J=T[D])||void 0===J?void 0:J.bind(T)}})(j,T);if(ie){const he=ie(...ee);return D=null==he?void 0:he.remove,he}throw new M(`"${w}.${T}()" is not implemented on ${P}`,N.Unimplemented)});return"addListener"===T&&(te.remove=(0,f.A)(function*(){return D()})),te};return J.toString=()=>`${T.toString()}() { [capacitor code] }`,Object.defineProperty(J,"name",{value:T,writable:!1,configurable:!1}),J},z=W("addListener"),oe=W("removeListener"),we=(T,D)=>{const J=z({eventName:T},D),ee=function(){var j=(0,f.A)(function*(){const ie=yield J;oe({eventName:T,callbackId:ie},D)});return function(){return j.apply(this,arguments)}}(),te=new Promise(j=>J.then(()=>j({remove:ee})));return te.remove=(0,f.A)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield ee()}),te},be=new Proxy({},{get(T,D){switch(D){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return L?we:z;case"removeListener":return oe;default:return W(D)}}});return O[w]=be,fe.set(w,{name:w,proxy:be,platforms:new Set([...Object.keys(y),...L?[P]:[]])}),be});return l.convertFileSrc||(l.convertFileSrc=w=>w),l.getPlatform=Z,l.handleError=w=>n.console.error(w),l.isNativePlatform=C,l.isPluginAvailable=B,l.pluginMethodNoop=(w,y,G)=>Promise.reject(`${G} does not have an implementation of "${y}".`),l.registerPlugin=pe,l.Exception=M,l.DEBUG=!!l.DEBUG,l.isLoggingEnabled=!!l.isLoggingEnabled,l.platform=l.getPlatform(),l.isNative=l.isNativePlatform(),l},h=(n=>n.Capacitor=de(n))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),R=h.registerPlugin;class U{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){var s=this;let a=!1;this.listeners[e]||(this.listeners[e]=[],a=!0),this.listeners[e].push(t);const p=this.windowListeners[e];p&&!p.registered&&this.addWindowListener(p),a&&this.sendRetainedArgumentsForEvent(e);const l=function(){var b=(0,f.A)(function*(){return s.removeListener(e,t)});return function(){return b.apply(this,arguments)}}();return Promise.resolve({remove:l})}removeAllListeners(){var e=this;return(0,f.A)(function*(){e.listeners={};for(const t in e.windowListeners)e.removeWindowListener(e.windowListeners[t]);e.windowListeners={}})()}notifyListeners(e,t,s){const a=this.listeners[e];if(a)a.forEach(o=>o(t));else if(s){let o=this.retainedEventArguments[e];o||(o=[]),o.push(t),this.retainedEventArguments[e]=o}}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:s=>{this.notifyListeners(t,s)}}}unimplemented(e="not implemented"){return new h.Exception(e,N.Unimplemented)}unavailable(e="not available"){return new h.Exception(e,N.Unavailable)}removeListener(e,t){var s=this;return(0,f.A)(function*(){const a=s.listeners[e];if(!a)return;const o=a.indexOf(t);s.listeners[e].splice(o,1),s.listeners[e].length||s.removeWindowListener(s.windowListeners[e])})()}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(s=>{this.notifyListeners(e,s)}))}}const d=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),r=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class u extends U{getCookies(){return(0,f.A)(function*(){const e=document.cookie,t={};return e.split(";").forEach(s=>{if(s.length<=0)return;let[a,o]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=r(a).trim(),o=r(o).trim(),t[a]=o}),t})()}setCookie(e){return(0,f.A)(function*(){try{const t=d(e.key),s=d(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,o=(e.path||"/").replace("path=",""),p=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${s||""}${a}; path=${o}; ${p};`}catch(t){return Promise.reject(t)}})()}deleteCookie(e){return(0,f.A)(function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}})()}clearCookies(){return(0,f.A)(function*(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})()}clearAllCookies(){var e=this;return(0,f.A)(function*(){try{yield e.clearCookies()}catch(t){return Promise.reject(t)}})()}}R("CapacitorCookies",{web:()=>new u});const $=function(){var n=(0,f.A)(function*(e){return new Promise((t,s)=>{const a=new FileReader;a.onload=()=>{const o=a.result;t(o.indexOf(",")>=0?o.split(",")[1]:o)},a.onerror=o=>s(o),a.readAsDataURL(e)})});return function(t){return n.apply(this,arguments)}}();class re extends U{request(e){return(0,f.A)(function*(){const t=((n,e={})=>{const t=Object.assign({method:n.method||"GET",headers:n.headers},e),a=((n={})=>{const e=Object.keys(n);return Object.keys(n).map(a=>a.toLocaleLowerCase()).reduce((a,o,p)=>(a[o]=n[e[p]],a),{})})(n.headers)["content-type"]||"";if("string"==typeof n.data)t.body=n.data;else if(a.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[p,l]of Object.entries(n.data||{}))o.set(p,l);t.body=o.toString()}else if(a.includes("multipart/form-data")||n.data instanceof FormData){const o=new FormData;if(n.data instanceof FormData)n.data.forEach((l,O)=>{o.append(O,l)});else for(const l of Object.keys(n.data))o.append(l,n.data[l]);t.body=o;const p=new Headers(t.headers);p.delete("content-type"),t.headers=p}else(a.includes("application/json")||"object"==typeof n.data)&&(t.body=JSON.stringify(n.data));return t})(e,e.webFetchExtra),s=((n,e=!0)=>n?Object.entries(n).reduce((s,a)=>{const[o,p]=a;let l,O;return Array.isArray(p)?(O="",p.forEach(b=>{l=e?encodeURIComponent(b):b,O+=`${o}=${l}&`}),O.slice(0,-1)):(l=e?encodeURIComponent(p):p,O=`${o}=${l}`),`${s}&${O}`},"").substr(1):null)(e.params,e.shouldEncodeUrlParams),a=s?`${e.url}?${s}`:e.url,o=yield fetch(a,t),p=o.headers.get("content-type")||"";let O,b,{responseType:l="text"}=o.ok?e:{};switch(p.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":b=yield o.blob(),O=yield $(b);break;case"json":O=yield o.json();break;default:O=yield o.text()}const q={};return o.headers.forEach((Z,ue)=>{q[ue]=Z}),{data:O,headers:q,status:o.status,url:o.url}})()}get(e){var t=this;return(0,f.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"GET"}))})()}post(e){var t=this;return(0,f.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"POST"}))})()}put(e){var t=this;return(0,f.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PUT"}))})()}patch(e){var t=this;return(0,f.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})()}delete(e){var t=this;return(0,f.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})()}}R("CapacitorHttp",{web:()=>new re})},5844:(me,ne,_)=>{_.d(ne,{u:()=>de});var f=_(467);class x extends Error{}function i(k,h){if("string"!=typeof k)throw new x("Invalid token specified: must be a string");h||(h={});const R=!0===h.header?0:1,c=k.split(".")[R];if("string"!=typeof c)throw new x(`Invalid token specified: missing part #${R+1}`);let m;try{m=function Y(k){let h=k.replace(/-/g,"+").replace(/_/g,"/");switch(h.length%4){case 0:break;case 2:h+="==";break;case 3:h+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function ae(k){return decodeURIComponent(atob(k).replace(/(.)/g,(h,R)=>{let c=R.charCodeAt(0).toString(16).toUpperCase();return c.length<2&&(c="0"+c),"%"+c}))}(h)}catch{return atob(h)}}(c)}catch(U){throw new x(`Invalid token specified: invalid base64 for part #${R+1} (${U.message})`)}try{return JSON.parse(m)}catch(U){throw new x(`Invalid token specified: invalid json for part #${R+1} (${U.message})`)}}x.prototype.name="InvalidTokenError";var ve=_(1626),le=_(8141),N=_(5312),M=_(1587),se=_(4438);let de=(()=>{var k;class h{constructor(c){this.http=c,this.apiUrl=`${N.c.apiUrl}`}login(c,m){return this.http.post(`${this.apiUrl}/auth/login`,{username:c,password:m}).pipe((0,le.M)(U=>{localStorage.setItem("authToken",U.access_token)}))}logout(){localStorage.removeItem("authToken")}isTokenValid(){const c=this.getToken();if(c)try{const m=i(c),U=new Date(0);return U.setUTCSeconds(m.exp),U>new Date}catch(m){return console.error("Erreur lors de la v\xe9rification du token JWT",m),!1}return!1}getToken(){return localStorage.getItem("authToken")||""}getUserId(){const c=this.getToken();if(c)try{const m=i(c);return m.userId||m.sub||""}catch(m){return console.error("Erreur lors du d\xe9codage du token JWT",m),""}return""}getUserHistory(c){const m=(new ve.Lr).set("Authorization",`Bearer ${this.getToken()}`);return this.http.get(`${this.apiUrl}/auth/user-history/${c}`,{headers:m})}isBiometricAvailable(){return(0,f.A)(function*(){try{return(yield M.qG.isAvailable()).isAvailable}catch{return!1}})()}verifyBiometric(c){return(0,f.A)(function*(){try{return yield M.qG.verifyIdentity({reason:c,title:"Authentification Biom\xe9trique",subtitle:"V\xe9rification",description:"Authentifiez-vous pour continuer",useFallback:!0,maxAttempts:3}),"biometric_token"}catch(m){return console.error("Erreur de v\xe9rification biom\xe9trique:",m),null}})()}recordArrival(c,m,U,ce){return this.http.post(`${this.apiUrl}/presence`,{qrData:c,location:{lat:m,lon:U},actionType:"arrival",biometricToken:ce})}recordDeparture(c,m,U,ce){return this.http.post(`${this.apiUrl}/presence`,{qrData:c,location:{lat:m,lon:U},actionType:"departure",biometricToken:ce})}getUserProfile(){const c=localStorage.getItem("authToken"),m=localStorage.getItem("userId");if(!c||!m)throw new Error("No auth token or user ID found");return this.http.get(`${this.apiUrl}/admin/users/profile/${m}`,{headers:{Authorization:`Bearer ${c}`}})}updateUserProfile(c){return this.http.put(`${this.apiUrl}/admin/users/update-profile/me`,c)}updateProfileImage(c){return this.http.put(`${this.apiUrl}/admin/users/update-profile-image`,{image:c})}}return(k=h).\u0275fac=function(c){return new(c||k)(se.KVO(ve.Qq))},k.\u0275prov=se.jDH({token:k,factory:k.\u0275fac,providedIn:"root"}),h})()},1587:(me,ne,_)=>{_.d(ne,{qG:()=>Y});const Y=(0,_(1200).F3)("NativeBiometric",{web:()=>_.e(5658).then(_.bind(_,5658)).then(i=>new i.NativeBiometricWeb)})},1200:(me,ne,_)=>{_.d(ne,{E_:()=>U,F3:()=>R});var f=_(467);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var N=function(d){return d.Unimplemented="UNIMPLEMENTED",d.Unavailable="UNAVAILABLE",d}(N||{});class M extends Error{constructor(r,u){super(r),this.message=r,this.code=u}}const de=d=>{var r,u,g,$,S;const F=d.CapacitorCustomPlatform||null,v=d.Capacitor||{},re=v.Plugins=v.Plugins||{},I=d.CapacitorPlatforms,e=(null===(r=null==I?void 0:I.currentPlatform)||void 0===r?void 0:r.getPlatform)||(()=>null!==F?F.name:(d=>{var r,u;return null!=d&&d.androidBridge?"android":null!==(u=null===(r=null==d?void 0:d.webkit)||void 0===r?void 0:r.messageHandlers)&&void 0!==u&&u.bridge?"ios":"web"})(d)),s=(null===(u=null==I?void 0:I.currentPlatform)||void 0===u?void 0:u.isNativePlatform)||(()=>"web"!==e()),o=(null===(g=null==I?void 0:I.currentPlatform)||void 0===g?void 0:g.isPluginAvailable)||(C=>{const E=q.get(C);return!!(null!=E&&E.platforms.has(e())||l(C))}),l=(null===($=null==I?void 0:I.currentPlatform)||void 0===$?void 0:$.getPluginHeader)||(C=>{var E;return null===(E=v.PluginHeaders)||void 0===E?void 0:E.find(B=>B.name===C)}),q=new Map,ue=(null===(S=null==I?void 0:I.currentPlatform)||void 0===S?void 0:S.registerPlugin)||((C,E={})=>{const B=q.get(C);if(B)return console.warn(`Capacitor plugin "${C}" already registered. Cannot register plugins twice.`),B.proxy;const X=e(),Q=l(C);let H;const Pe=function(){var P=(0,f.A)(function*(){return!H&&X in E?H=H="function"==typeof E[X]?yield E[X]():E[X]:null!==F&&!H&&"web"in E&&(H=H="function"==typeof E.web?yield E.web():E.web),H});return function(){return P.apply(this,arguments)}}(),ge=P=>{let L;const A=(...K)=>{const V=Pe().then(W=>{const z=((P,L)=>{var A,K;if(!Q){if(P)return null===(K=P[L])||void 0===K?void 0:K.bind(P);throw new M(`"${C}" plugin is not implemented on ${X}`,N.Unimplemented)}{const V=null==Q?void 0:Q.methods.find(W=>L===W.name);if(V)return"promise"===V.rtype?W=>v.nativePromise(C,L.toString(),W):(W,z)=>v.nativeCallback(C,L.toString(),W,z);if(P)return null===(A=P[L])||void 0===A?void 0:A.bind(P)}})(W,P);if(z){const oe=z(...K);return L=null==oe?void 0:oe.remove,oe}throw new M(`"${C}.${P}()" is not implemented on ${X}`,N.Unimplemented)});return"addListener"===P&&(V.remove=(0,f.A)(function*(){return L()})),V};return A.toString=()=>`${P.toString()}() { [capacitor code] }`,Object.defineProperty(A,"name",{value:P,writable:!1,configurable:!1}),A},pe=ge("addListener"),w=ge("removeListener"),y=(P,L)=>{const A=pe({eventName:P},L),K=function(){var W=(0,f.A)(function*(){const z=yield A;w({eventName:P,callbackId:z},L)});return function(){return W.apply(this,arguments)}}(),V=new Promise(W=>A.then(()=>W({remove:K})));return V.remove=(0,f.A)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield K()}),V},G=new Proxy({},{get(P,L){switch(L){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return Q?y:pe;case"removeListener":return w;default:return ge(L)}}});return re[C]=G,q.set(C,{name:C,proxy:G,platforms:new Set([...Object.keys(E),...Q?[X]:[]])}),G});return v.convertFileSrc||(v.convertFileSrc=C=>C),v.getPlatform=e,v.handleError=C=>d.console.error(C),v.isNativePlatform=s,v.isPluginAvailable=o,v.pluginMethodNoop=(C,E,B)=>Promise.reject(`${B} does not have an implementation of "${E}".`),v.registerPlugin=ue,v.Exception=M,v.DEBUG=!!v.DEBUG,v.isLoggingEnabled=!!v.isLoggingEnabled,v.platform=v.getPlatform(),v.isNative=v.isNativePlatform(),v},h=(d=>d.Capacitor=de(d))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),R=h.registerPlugin;class U{constructor(r){this.listeners={},this.windowListeners={},r&&(console.warn(`Capacitor WebPlugin "${r.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=r)}addListener(r,u){var g=this;this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push(u);const S=this.windowListeners[r];S&&!S.registered&&this.addWindowListener(S);const F=function(){var re=(0,f.A)(function*(){return g.removeListener(r,u)});return function(){return re.apply(this,arguments)}}(),v=Promise.resolve({remove:F});return Object.defineProperty(v,"remove",{value:(re=(0,f.A)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield F()}),function(){return re.apply(this,arguments)})}),v;var re}removeAllListeners(){var r=this;return(0,f.A)(function*(){r.listeners={};for(const u in r.windowListeners)r.removeWindowListener(r.windowListeners[u]);r.windowListeners={}})()}notifyListeners(r,u){const g=this.listeners[r];g&&g.forEach($=>$(u))}hasListeners(r){return!!this.listeners[r].length}registerWindowListener(r,u){this.windowListeners[u]={registered:!1,windowEventName:r,pluginEventName:u,handler:g=>{this.notifyListeners(u,g)}}}unimplemented(r="not implemented"){return new h.Exception(r,N.Unimplemented)}unavailable(r="not available"){return new h.Exception(r,N.Unavailable)}removeListener(r,u){var g=this;return(0,f.A)(function*(){const $=g.listeners[r];if(!$)return;const S=$.indexOf(u);g.listeners[r].splice(S,1),g.listeners[r].length||g.removeWindowListener(g.windowListeners[r])})()}addWindowListener(r){window.addEventListener(r.windowEventName,r.handler),r.registered=!0}removeWindowListener(r){r&&(window.removeEventListener(r.windowEventName,r.handler),r.registered=!1)}}}}]);